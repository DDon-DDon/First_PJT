{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Evidence Card",
  "description": "기획서에 인용할 수 있는 최소 단위(주장/근거/링크/맥락)",
  "type": "object",
  "required": ["evidence_id", "claim", "evidence_type", "stance", "source", "entities", "created_at"],
  "properties": {
    "evidence_id": {
      "type": "string",
      "description": "고유 식별자 (예: ev_20251227_000001)",
      "pattern": "^ev_\\d{8}_\\d{6}$"
    },
    "claim": {
      "type": "string",
      "description": "기획에 인용할 주장 문장",
      "minLength": 10,
      "maxLength": 500
    },
    "evidence_type": {
      "type": "string",
      "enum": ["review", "blog", "paper", "pricing", "forum", "vendor_doc", "case_study"],
      "description": "근거 유형"
    },
    "stance": {
      "type": "string",
      "enum": ["supports", "contradicts", "neutral"],
      "description": "주장에 대한 입장"
    },
    "snippet": {
      "type": "object",
      "properties": {
        "text": {
          "type": "string",
          "description": "1-2 문장 발췌/패러프레이즈"
        },
        "start_char": {
          "type": "integer",
          "description": "원문에서의 시작 위치"
        },
        "end_char": {
          "type": "integer",
          "description": "원문에서의 끝 위치"
        }
      },
      "required": ["text"]
    },
    "source": {
      "type": "object",
      "properties": {
        "doc_id": {
          "type": "string",
          "description": "연결된 문서 ID"
        },
        "url": {
          "type": "string",
          "format": "uri",
          "description": "원본 URL"
        },
        "retrieved_at": {
          "type": "string",
          "format": "date-time",
          "description": "수집 일시"
        }
      },
      "required": ["url", "retrieved_at"]
    },
    "entities": {
      "type": "object",
      "properties": {
        "domain": {
          "type": "string",
          "description": "도메인 (예: small_retail_osa)"
        },
        "target_user": {
          "type": "array",
          "items": { "type": "string" },
          "description": "대상 사용자 역할"
        },
        "pain_point": {
          "type": "array",
          "items": { "type": "string" },
          "description": "페인포인트 태그"
        },
        "job_to_be_done": {
          "type": "array",
          "items": { "type": "string" },
          "description": "JTBD 태그"
        },
        "constraints": {
          "type": "array",
          "items": { "type": "string" },
          "description": "제약 조건"
        }
      },
      "required": ["domain"]
    },
    "metrics_hint": {
      "type": "object",
      "properties": {
        "osa_oos_related": {
          "type": "boolean",
          "description": "OSA/OOS 관련 여부"
        },
        "kpi_candidates": {
          "type": "array",
          "items": { "type": "string" },
          "description": "KPI 후보"
        }
      }
    },
    "quality": {
      "type": "object",
      "properties": {
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "신뢰도 점수"
        },
        "reason": {
          "type": "string",
          "description": "신뢰도 판단 근거"
        }
      }
    },
    "tags": {
      "type": "array",
      "items": { "type": "string" },
      "description": "추가 태그 (예: mvp_relevant, alerting)"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "생성 일시"
    },
    "pipeline": {
      "type": "object",
      "properties": {
        "extractor": {
          "type": "string",
          "description": "추출에 사용된 스크립트"
        },
        "run_id": {
          "type": "string",
          "description": "실행 ID"
        }
      }
    }
  }
}